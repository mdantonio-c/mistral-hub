<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h4 class="modal-title mb-0">{{ province }}</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="activeModal.dismiss()"
    ></button>
  </div>
  <div class="card-body" [ngSwitch]="selectedMetric">
    <div class="d-flex button-container">
      <button
        class="btn btn-outline-secondary me-2"
        [class.active]="selectedMetric === 'TM'"
        (click)="selectMetric('TM')"
      >
        {{ "Maximum Temperature" | translate : lang }}
      </button>
      <button
        class="btn btn-outline-secondary me-2"
        [class.active]="selectedMetric === 'Tm'"
        (click)="selectMetric('Tm')"
      >
        {{ "Minimum Temperature" | translate : lang }}
      </button>
      <button
        class="btn btn-outline-secondary"
        [class.active]="selectedMetric === 'P'"
        (click)="selectMetric('P')"
      >
        {{ "Total Precipitation" | translate : lang }}
      </button>
    </div>

    <div #containerRef>
      <combo-chart-seasonal-component
        *ngIf="lineChart?.length > 0"
        [view]="[containerRef.offsetWidth, 400]"
        [yAxisLabel]="yLabel"
        [results]="currentResults"
        [scheme]="colorScheme"
        [lineChart]="lineChart"
        [yScaleMin]="yMin"
        [yScaleMax]="yMax"
        [selectedMetric]="selectedMetric"
      >
        <ng-template #seriesTooltipTemplate let-model="model">
          <div class="area-tooltip-container">
            <span class="d-block"
              ><b>{{ model[0].name }} [percentiles]</b></span
            >
            <div class="boxplot-values"><b>Climate</b>:</div>
            <div class="tooltip-item d-flex">
              <div class="tooltip-item-color-container">
                <span
                  class="tooltip-item-color"
                  [style.background-color]="
                    selectedMetric === 'TM' || selectedMetric === 'Tm'
                      ? lineColors[2][0]
                      : lineColors[2][1]
                  "
                ></span>
              </div>
              <span
                >{{ "90th" }} : <b>{{ model[2].value }}</b> {{ boxUnit }}</span
              >
            </div>
            <div class="tooltip-item d-flex">
              <div class="tooltip-item-color-container">
                <span
                  class="tooltip-item-color"
                  [style.background-color]="
                    selectedMetric === 'TM' || selectedMetric === 'Tm'
                      ? lineColors[0][0]
                      : lineColors[0][1]
                  "
                ></span>
              </div>
              <span
                >{{ "50th" }} : <b>{{ model[0].value }}</b> {{ boxUnit }}</span
              >
            </div>
            <div class="tooltip-item d-flex">
              <div class="tooltip-item-color-container">
                <span
                  class="tooltip-item-color"
                  [style.background-color]="
                    selectedMetric === 'TM' || selectedMetric === 'Tm'
                      ? lineColors[1][0]
                      : lineColors[1][1]
                  "
                ></span>
              </div>
              <span
                >{{ "10th" }} : <b>{{ model[1].value }}</b> {{ boxUnit }}</span
              >
            </div>
            <span class="boxplot-values"><b>Forecast</b></span>
            <div class="boxplot-values">
              90th: <b>{{ currentMonthlyMap[model[0].name][4].value }} </b>
              {{ boxUnit }}
            </div>
            <div class="boxplot-values">
              75th: <b>{{ currentMonthlyMap[model[0].name][3].value }} </b>
              {{ boxUnit }}
            </div>
            <div class="boxplot-values">
              50th: <b>{{ currentMonthlyMap[model[0].name][2].value }} </b>
              {{ boxUnit }}
            </div>
            <div class="boxplot-values">
              25th: <b>{{ currentMonthlyMap[model[0].name][1].value }} </b>
              {{ boxUnit }}
            </div>
            <div class="boxplot-values">
              10th: <b>{{ currentMonthlyMap[model[0].name][0].value }} </b>
              {{ boxUnit }}
            </div>
          </div>
        </ng-template>
      </combo-chart-seasonal-component>
    </div>
  </div>
</div>
